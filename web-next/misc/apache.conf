# Apache configuration for ZoneMinder Next-Gen Web UI
# Include this in your Apache config or place in conf.d/
#
# Assumes ZoneMinder is at /zm/ and web-next is installed alongside it.

Alias /zm-next /usr/share/zoneminder/web-next

<Directory /usr/share/zoneminder/web-next>
    Options -Indexes +FollowSymLinks
    AllowOverride None
    Require all granted

    # SPA fallback: serve index.html for all routes
    RewriteEngine On
    RewriteBase /zm-next/
    RewriteRule ^index\.html$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /zm-next/index.html [L]
</Directory>

# Route API requests to existing ZoneMinder API (no proxy needed, same server)
# The SPA calls /api/... which needs to map to /zm/api/...
RewriteEngine On
RewriteRule ^/api/(.*)$ /zm/api/$1 [PT,L]
